{"ast":null,"code":"import Pagination from \"@/components/Pagination.vue\";\nexport default {\n  data() {\n    return {\n      sign: null,\n      loginName: \"aa\",\n      tableData: [],\n      tableDataSearch: [],\n      formInline: {\n        headerInput: \"\",\n        statusInput: \"\"\n      },\n      currentPage: 1,\n      pageSize: 10\n    };\n  },\n\n  computed: {\n    totalMoney() {\n      let totalMoney = 0;\n\n      for (let i = 0; i < this.tableData.length; i++) {\n        totalMoney += this.tableData[i].invoice_money;\n      }\n\n      return totalMoney;\n    },\n\n    totalNum() {\n      return this.tableData.length;\n    }\n\n  },\n  filters: {\n    invoiceStatusFormat(val) {\n      return val == 1 ? \"未开票\" : val == 2 ? \"待开票\" : \"已开票\";\n    },\n\n    checkStatusFormat(val) {\n      return val == 1 ? \"待审核\" : \"已审核\";\n    }\n\n  },\n  components: {\n    Pagination\n  },\n  methods: {\n    onSubmit() {\n      if (this.formInline.statusInput === \"\") {\n        this.tableDataSearch = this.tableData.filter(item => {\n          return item.invoice_header.indexOf(this.formInline.headerInput) !== -1;\n        });\n      } else if (this.formInline.headerInput === \"\") {\n        this.tableDataSearch = this.tableData.filter(item => {\n          return item.invoice_status.indexOf(this.formInline.statusInput) !== -1;\n        });\n      } else {\n        this.tableDataSearch = this.tableData.filter(item => {\n          return item.invoice_status.indexOf(this.formInline.statusInput) !== -1 && item.invoice_header.indexOf(this.formInline.headerInput) !== -1;\n        });\n      }\n    },\n\n    currentChange(data) {\n      this.currentPage = data.currentPage;\n      let time = parseInt(new Date().getTime() / 1000) + \"\"; //获取10位时间戳\n\n      this.invoicedList(time);\n    },\n\n    sizeChange(data) {\n      this.pageSize = data.pageSize;\n      let time = parseInt(new Date().getTime() / 1000) + \"\"; //获取10位时间戳\n\n      this.invoicedList(time);\n    },\n\n    async getSign(time, data2) {\n      let data = data2;\n      data[\"key\"] = \"c4ca4238a0b923820dcc509a6f75849b\";\n      data[\"timestamp\"] = time;\n      await this.$axios({\n        method: \"post\",\n        url: \"https://wemall.minephone.com/Invoice/api/public/index.php/api/Apibase/getSign\",\n        data: data\n      }).then(result => {\n        this.sign = result.data.data;\n      });\n    },\n\n    async login(time) {\n      let data1 = {\n        account: \"admin\",\n        password: \"123456\",\n        type: \"admin\"\n      };\n      await this.getSign(time, data1);\n      let data = {\n        account: \"admin\",\n        password: \"123456\",\n        type: \"admin\",\n        sign: this.sign,\n        key: \"c4ca4238a0b923820dcc509a6f75849b\",\n        timestamp: time\n      };\n      this.$axios({\n        method: \"post\",\n        url: \"https://wemall.minephone.com/Invoice/api/public/index.php/api/login/Login\",\n        data: data\n      }).then(result => {\n        this.loginName = result.data.data.nickname;\n      });\n    },\n\n    async invoicedList(time) {\n      let data1 = {\n        page: this.currentPage,\n        limit: this.pageSize,\n        invoice_header: \"\"\n      };\n      await this.getSign(time, data1);\n      let data = {\n        page: this.currentPage,\n        limit: this.pageSize,\n        invoice_header: \"\",\n        sign: this.sign,\n        key: \"c4ca4238a0b923820dcc509a6f75849b\",\n        timestamp: time\n      };\n      this.$axios({\n        method: \"post\",\n        url: \"https://wemall.minephone.com/Invoice/api/public/index.php/api/admin/invoicedList\",\n        data: data\n      }).then(result => {\n        this.tableData = result.data.data.list;\n        this.tableDataSearch = result.data.data.list;\n      });\n    }\n\n  },\n\n  async mounted() {\n    let time = parseInt(new Date().getTime() / 1000) + \"\"; //获取10位时间戳\n\n    this.login(time);\n    this.invoicedList(time);\n  },\n\n  updated() {\n    window.onresize = () => {\n      if (this.$refs.table && this.$refs.table.doLayout) {\n        this.$refs.table.doLayout();\n      }\n    };\n  }\n\n};","map":{"version":3,"mappings":"AA8EA;AACA;EACAA;IACA;MACAC,UADA;MAEAC,eAFA;MAGAC,aAHA;MAIAC,mBAJA;MAKAC;QACAC,eADA;QAEAC;MAFA,CALA;MASAC,cATA;MAUAC;IAVA;EAYA,CAdA;;EAeAC;IACAC;MACA;;MACA;QACAA;MACA;;MACA;IACA,CAPA;;IAQAC;MACA;IACA;;EAVA,CAfA;EA2BAC;IACAC;MACA;IACA,CAHA;;IAIAC;MACA;IACA;;EANA,CA3BA;EAmCAC;IACAC;EADA,CAnCA;EAsCAC;IACAC;MACA;QACA;UACA,OACAC,+DADA;QAGA,CAJA;MAKA,CANA,MAMA;QACA;UACA,OACAA,+DADA;QAGA,CAJA;MAKA,CANA,MAMA;QACA;UACA,OACAA,mEACAA,+DAFA;QAIA,CALA;MAMA;IACA,CAtBA;;IAuBAC;MACA;MACA,sDAFA,CAEA;;MACA;IACA,CA3BA;;IA4BAC;MACA;MACA,sDAFA,CAEA;;MACA;IACA,CAhCA;;IAiCA;MACA;MACAtB;MACAA;MACA;QACAuB,cADA;QAEAC,oFAFA;QAGAxB;MAHA,GAIAyB,IAJA,CAIAC;QACA;MACA,CANA;IAOA,CA5CA;;IA6CA;MACA;QACAC,gBADA;QAEAC,kBAFA;QAGAC;MAHA;MAMA;MACA;QACAF,gBADA;QAEAC,kBAFA;QAGAC,aAHA;QAIA5B,eAJA;QAKA6B,uCALA;QAMAC;MANA;MAQA;QACAR,cADA;QAEAC,gFAFA;QAGAxB;MAHA,GAIAyB,IAJA,CAIAC;QACA;MACA,CANA;IAOA,CApEA;;IAqEA;MACA;QACAM,sBADA;QAEAC,oBAFA;QAGAC;MAHA;MAMA;MACA;QACAF,sBADA;QAEAC,oBAFA;QAGAC,kBAHA;QAIAjC,eAJA;QAKA6B,uCALA;QAMAC;MANA;MAQA;QACAR,cADA;QAEAC,uFAFA;QAGAxB;MAHA,GAIAyB,IAJA,CAIAC;QACA;QACA;MACA,CAPA;IAQA;;EA7FA,CAtCA;;EAsIA;IACA,sDADA,CACA;;IACA;IACA;EACA,CA1IA;;EA2IAS;IACAC;MACA;QACA;MACA;IACA,CAJA;EAKA;;AAjJA","names":["data","sign","loginName","tableData","tableDataSearch","formInline","headerInput","statusInput","currentPage","pageSize","computed","totalMoney","totalNum","filters","invoiceStatusFormat","checkStatusFormat","components","Pagination","methods","onSubmit","item","currentChange","sizeChange","method","url","then","result","account","password","type","key","timestamp","page","limit","invoice_header","updated","window"],"sourceRoot":"src/views/already","sources":["Already.vue"],"sourcesContent":["<template>\r\n  <div>\r\n    <el-form :inline=\"true\" :model=\"formInline\" class=\"demo-form-inline\">\r\n      <el-form-item label=\"发票抬头\">\r\n        <el-input\r\n          v-model=\"formInline.headerInput\"\r\n          placeholder=\"请输入\"\r\n        ></el-input>\r\n      </el-form-item>\r\n      <el-form-item label=\"状态\">\r\n        <el-select v-model=\"formInline.statusInput\" placeholder=\"全部\">\r\n          <el-option label=\"全部\" value=\"\"></el-option>\r\n          <el-option label=\"已审核,已开票\" value=\"3\"></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <el-button type=\"primary\" @click=\"onSubmit\">搜索</el-button>\r\n      </el-form-item>\r\n    </el-form>\r\n    <div class=\"total-num\">\r\n      <div>\r\n        总计金额:\r\n        <span>{{ totalMoney }}元</span>\r\n      </div>\r\n      |\r\n      <div>\r\n        总开票数: <span>{{ totalNum }}笔</span>\r\n      </div>\r\n    </div>\r\n    <el-table\r\n      border\r\n      :data=\"\r\n        tableDataSearch.slice(\r\n          (currentPage - 1) * pageSize,\r\n          currentPage * pageSize\r\n        )\r\n      \"\r\n      :header-cell-style=\"{\r\n        background: '#E9E9E9',\r\n        color: '#555',\r\n      }\"\r\n      :row-style=\"{ height: '30px' }\"\r\n      :max-height=\"400\"\r\n    >\r\n      <el-table-column prop=\"invoice_header\" label=\"发票抬头\" width=\"140\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"invoice_number\" label=\"税号\" width=\"120\">\r\n      </el-table-column>\r\n      <el-table-column prop=\"address\" label=\"发票内容\"> </el-table-column>\r\n      <el-table-column prop=\"invoice_money\" label=\"发票金额\"> </el-table-column>\r\n      <el-table-column prop=\"check_status\" label=\"备注说明\"></el-table-column>\r\n      <el-table-column prop=\"invoice_status\" label=\"状态\">\r\n        <template slot-scope=\"scope\">\r\n          {{ scope.row.check_status | checkStatusFormat }},{{\r\n            scope.row.invoice_status | invoiceStatusFormat\r\n          }}\r\n        </template>\r\n      </el-table-column>\r\n      <el-table-column prop=\"createtime\" label=\"最后操作日期\">\r\n      </el-table-column>\r\n      <el-table-column fixed=\"right\" label=\"操作\" width=\"120\">\r\n        <template slot-scope=\"scope\">\r\n          <router-link :to=\"{ path: '/already1', query: { id: scope.row.id } }\">\r\n            <el-button type=\"text\" size=\"small\"> 查看 </el-button>\r\n          </router-link>\r\n        </template>\r\n      </el-table-column>\r\n    </el-table>\r\n    <Pagination\r\n      :currentPage=\"currentPage\"\r\n      :pageSize=\"pageSize\"\r\n      @paginationCurrent=\"currentChange\"\r\n      @paginationSize=\"sizeChange\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n  <script>\r\nimport Pagination from \"@/components/Pagination.vue\";\r\nexport default {\r\n  data() {\r\n    return {\r\n      sign: null,\r\n      loginName: \"aa\",\r\n      tableData: [],\r\n      tableDataSearch: [],\r\n      formInline: {\r\n        headerInput: \"\",\r\n        statusInput: \"\",\r\n      },\r\n      currentPage: 1,\r\n      pageSize: 10,\r\n    };\r\n  },\r\n  computed: {\r\n    totalMoney() {\r\n      let totalMoney = 0;\r\n      for (let i = 0; i < this.tableData.length; i++) {\r\n        totalMoney += this.tableData[i].invoice_money;\r\n      }\r\n      return totalMoney;\r\n    },\r\n    totalNum() {\r\n      return this.tableData.length;\r\n    },\r\n  },\r\n  filters: {\r\n    invoiceStatusFormat(val) {\r\n      return val == 1 ? \"未开票\" : val == 2 ? \"待开票\" : \"已开票\";\r\n    },\r\n    checkStatusFormat(val) {\r\n      return val == 1 ? \"待审核\" : \"已审核\";\r\n    },\r\n  },\r\n  components: {\r\n    Pagination,\r\n  },\r\n  methods: {\r\n    onSubmit() {\r\n      if (this.formInline.statusInput === \"\") {\r\n        this.tableDataSearch = this.tableData.filter((item) => {\r\n          return (\r\n            item.invoice_header.indexOf(this.formInline.headerInput) !== -1\r\n          );\r\n        });\r\n      } else if (this.formInline.headerInput === \"\") {\r\n        this.tableDataSearch = this.tableData.filter((item) => {\r\n          return (\r\n            item.invoice_status.indexOf(this.formInline.statusInput) !== -1\r\n          );\r\n        });\r\n      } else {\r\n        this.tableDataSearch = this.tableData.filter((item) => {\r\n          return (\r\n            item.invoice_status.indexOf(this.formInline.statusInput) !== -1 &&\r\n            item.invoice_header.indexOf(this.formInline.headerInput) !== -1\r\n          );\r\n        });\r\n      }\r\n    },\r\n    currentChange(data) {\r\n      this.currentPage = data.currentPage;\r\n      let time = parseInt(new Date().getTime() / 1000) + \"\"; //获取10位时间戳\r\n      this.invoicedList(time);\r\n    },\r\n    sizeChange(data) {\r\n      this.pageSize = data.pageSize;\r\n      let time = parseInt(new Date().getTime() / 1000) + \"\"; //获取10位时间戳\r\n      this.invoicedList(time);\r\n    },\r\n    async getSign(time, data2) {\r\n      let data = data2;\r\n      data[\"key\"] = \"c4ca4238a0b923820dcc509a6f75849b\";\r\n      data[\"timestamp\"] = time;\r\n      await this.$axios({\r\n        method: \"post\",\r\n        url: \"https://wemall.minephone.com/Invoice/api/public/index.php/api/Apibase/getSign\",\r\n        data: data,\r\n      }).then((result) => {\r\n        this.sign = result.data.data;\r\n      });\r\n    },\r\n    async login(time) {\r\n      let data1 = {\r\n        account: \"admin\",\r\n        password: \"123456\",\r\n        type: \"admin\",\r\n      };\r\n\r\n      await this.getSign(time, data1);\r\n      let data = {\r\n        account: \"admin\",\r\n        password: \"123456\",\r\n        type: \"admin\",\r\n        sign: this.sign,\r\n        key: \"c4ca4238a0b923820dcc509a6f75849b\",\r\n        timestamp: time,\r\n      };\r\n      this.$axios({\r\n        method: \"post\",\r\n        url: \"https://wemall.minephone.com/Invoice/api/public/index.php/api/login/Login\",\r\n        data: data,\r\n      }).then((result) => {\r\n        this.loginName = result.data.data.nickname;\r\n      });\r\n    },\r\n    async invoicedList(time) {\r\n      let data1 = {\r\n        page: this.currentPage,\r\n        limit: this.pageSize,\r\n        invoice_header: \"\",\r\n      };\r\n\r\n      await this.getSign(time, data1);\r\n      let data = {\r\n        page: this.currentPage,\r\n        limit: this.pageSize,\r\n        invoice_header: \"\",\r\n        sign: this.sign,\r\n        key: \"c4ca4238a0b923820dcc509a6f75849b\",\r\n        timestamp: time,\r\n      };\r\n      this.$axios({\r\n        method: \"post\",\r\n        url: \"https://wemall.minephone.com/Invoice/api/public/index.php/api/admin/invoicedList\",\r\n        data: data,\r\n      }).then((result) => {\r\n        this.tableData = result.data.data.list;\r\n        this.tableDataSearch = result.data.data.list;\r\n      });\r\n    },\r\n  },\r\n\r\n  async mounted() {\r\n    let time = parseInt(new Date().getTime() / 1000) + \"\"; //获取10位时间戳\r\n    this.login(time);\r\n    this.invoicedList(time);\r\n  },\r\n  updated() {\r\n    window.onresize = () => {\r\n      if (this.$refs.table && this.$refs.table.doLayout) {\r\n        this.$refs.table.doLayout();\r\n      }\r\n    };\r\n  },\r\n};\r\n</script>\r\n\r\n<style>\r\n.el-aside {\r\n  color: #333;\r\n  height: 100%;\r\n  background-color: #3f3f3f;\r\n  color: #979797;\r\n}\r\n.el-submenu__title {\r\n  color: #979797 !important;\r\n}\r\n.el-submenu,\r\n.el-menu-item {\r\n  background-color: #3f3f3f;\r\n  color: #979797 !important;\r\n}\r\n.el-form {\r\n  background-color: #f7f7f7;\r\n}\r\n.el-form-item {\r\n  margin-top: 22px;\r\n  margin-left: 22px;\r\n}\r\n.el-container .is-vertical {\r\n  height: 100vh;\r\n}\r\n.total-num {\r\n  width: 100%;\r\n  height: 50px;\r\n  display: flex;\r\n  line-height: 50px;\r\n  font-size: 14px;\r\n}\r\n.total-num > div {\r\n  width: 180px;\r\n  height: 50px;\r\n  line-height: 50px;\r\n  text-align: center;\r\n}\r\n.total-num > div > span {\r\n  color: rgb(5, 158, 5);\r\n}\r\n.page {\r\n  text-align: right;\r\n  margin-top: 50px;\r\n}\r\n.el-table {\r\n  width: 100%;\r\n\r\n  display: flex;\r\n\r\n  flex-direction: column;\r\n}\r\n.el-table__body-wrapper {\r\n  flex: 1;\r\n}\r\n</style>\r\n    "]},"metadata":{},"sourceType":"module"}